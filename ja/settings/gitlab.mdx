---
title: "GitLab"
description: "GitLab リポジトリとドキュメントを同期する"
icon: "gitlab"
---

GitLab と Mintlify 間の認証と変更の同期には、Access token と Webhook を組み合わせて使用します。

- GitLab から情報を取得するために Access token を使用します。
- 変更があった際に GitLab から Mintlify へ通知するために Webhook を使用します。
  - これにより、MR 作成時に Mintlify がプレビューデプロイを作成できます。

<div id="set-up-the-connection">
  ## 接続を設定する
</div>

<Steps>
  <Step title="プロジェクトIDを見つける">
    GitLabのプロジェクトで、`Settings` > `General` に移動し、`Project ID` を確認します。
    <Frame>
      <img src="/images/gitlab/gitlab-project-id.png" />
    </Frame>
  </Step>
  <Step title="アクセストークンを生成する">
    a. `Settings` > `Access Tokens` に移動します。

    b. `Add new token` を選択します。
      1. トークン名を「Mintlify」にします。
      2. プライベートリポジトリの場合は、ロールを `Maintainer` に設定します。
      3. スコープに `api` と `read_api` を選択します。

    c. 最後に `Create project access token` をクリックし、トークンをコピーします。

    <Frame>
      <img src="/images/gitlab/gitlab-project-access-token.png" />
    </Frame>

  </Step>
  <Step title="接続を設定する">
    [Mintlify dashboard](https://dashboard.mintlify.com/settings/deployment/git-settings) で、前の手順で取得したプロジェクトIDとアクセストークンを他の設定とあわせて追加します。完了したら「Save Changes」をクリックします。
    <Frame>
      <img src="/images/gitlab/gitlab-config.png" />
    </Frame>
  </Step>
</Steps>

<div id="create-the-webhook">
  ## Webhook を作成する
</div>

Webhook を使うと、変更が加えられた際のイベントを受信し、自動でデプロイをトリガーできます。

<Steps>
  <Step title="Settings > Webhooks に移動し「Add new Webhook」をクリック">
    <Frame>
      <img src="/images/gitlab/gitlab-webhook.png" />
    </Frame>
  </Step>
  <Step title="URL と Webhook を設定">
    「URL」フィールドにエンドポイント `https://leaves.mintlify.com/gitlab-webhook` を入力し、Webhook 名を「Mintlify」に設定します。

  </Step>
  <Step title="トークンを貼り付け">
    接続の設定後に生成された Webhook トークンを貼り付けます。
    <Frame>
      <img src="/images/gitlab/gitlab-show-webtoken.png" />
    </Frame>
  </Step>
  <Step title="イベントを選択">
    Webhook をトリガーしたいイベントを選択します:
      - Push events (All branches)
      - Merge requests events
      
    設定後は次のようになります:
    <Frame>
      <img src="/images/gitlab/gitlab-project-webtoken.png" />
    </Frame>
  </Step>
  <Step title="Webhook をテスト">
    Webhook を作成したら、「Test」ドロップダウンをクリックして「Push events」を選択し、サンプルペイロードを送信して正しく設定されているか確認します。正しく設定されていれば「Hook executed successfully: HTTP 200」と表示されます。

    これにより、すべてが正常に動作しており、ドキュメントが GitLab リポジトリと正しく同期されることを確認できます。
    <Frame>
      <img src="/images/gitlab/gitlab-project-webtoken-test.png" />
    </Frame>

  </Step>
</Steps>

<Note>
  サポートが必要な場合は Mintlify チームまでお問い合わせください。ご連絡は
  [こちら](https://mintlify.com/enterprise)から。
</Note>

[git-settings]: https://dashboard.mintlify.com/settings/deployment/git-settings